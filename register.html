<script>

async function registerUser(){

let name=document.getElementById("name").value.trim();

let email=document.getElementById("email").value.trim();

let pass=document.getElementById("password").value.trim();

let referCodeInput=
prompt("Referral Code (optional)");


if(!name||!email||!pass){

alert("Fill Fields");

return;

}


// LOAD USERS

let users=await getDB("users");


// DUPLICATE

if(users.find(u=>u.email===email)){

alert("Email Exists");

return;

}


// â­ CREATE REFERRAL CODE

let myCode=

Math.random()

.toString(36)

.substring(2,8)

.toUpperCase();


// SAVE USER

users.push({

name:name,

email:email,

password:pass,

role:"user",

seller:false,

refCode:myCode,

referredBy:

referCodeInput||"",

date:new Date()

.toLocaleString()

});


await saveDB("users",users);


// â­ WALLET CREATE

let wallets=

await getDB("wallets");

wallets[email]=0;

await saveDB(

"wallets",

wallets

);


// â­ FREE EBOOK REWARD

if(referCodeInput){

let refUser=

users.find(

u=>u.refCode===referCodeInput

);


if(refUser){

let library=

await getDB("library");


// FREE BOOK ID

library.push({

user:refUser.email,

productId:

"FREE_EBOOK",

date:

new Date()

.toLocaleString()

});


await saveDB(

"library",

library

);

}

}


// AUTO LOGIN

localStorage.setItem(

"user",

JSON.stringify({

name:name,

email:email

})

);


alert(

"Account Created ðŸ˜ŽðŸ”¥"

);


location.href="dashboard.html";

}

</script>
