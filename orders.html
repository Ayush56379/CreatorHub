<!DOCTYPE html>
<html lang="en">

<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>My Orders - CreatorHub</title>

<style>

/* ================= THEME ================= */

:root{
--bg:#ffffff;
--text:#111827;
--card:#f3f4f6;
--accent:#22c55e;
}

@media(prefers-color-scheme:dark){
:root{
--bg:#020617;
--text:#ffffff;
--card:#111827;
}
}

body{
margin:0;
font-family:Arial;
background:var(--bg);
color:var(--text);
}


/* ================= HEADER ================= */

.topbar{
display:flex;
align-items:center;
padding:14px;
background:var(--bg);
box-shadow:0 5px 20px rgba(0,0,0,.3);
position:sticky;
top:0;
z-index:999;
}

.back{
font-size:22px;
cursor:pointer;
width:40px;
}

.pageTitle{
flex:1;
text-align:center;
font-size:18px;
font-weight:bold;
color:var(--accent);
}

.dashboard{
background:var(--accent);
padding:8px 14px;
border-radius:20px;
font-size:13px;
color:white;
text-decoration:none;
}


/* ================= CONTAINER ================= */

.container{
padding:18px;
}


/* ================= CARD ================= */

.card{
background:var(--card);
padding:14px;
border-radius:14px;
margin-bottom:15px;
display:flex;
gap:15px;
align-items:center;
box-shadow:0 8px 20px rgba(0,0,0,.25);
transition:.3s;
}

.card:hover{
transform:translateY(-4px);
}

.card img{
width:90px;
height:110px;
object-fit:cover;
border-radius:10px;
}


/* ================= DETAILS ================= */

.details{
flex:1;
}

.bookTitle{
font-size:16px;
font-weight:bold;
margin-bottom:5px;
}

.price{
color:var(--accent);
margin-bottom:5px;
}

.date{
font-size:13px;
opacity:.8;
margin-bottom:8px;
}


/* ================= BUTTON ================= */

.download{
background:linear-gradient(90deg,#22c55e,#4ade80);
border:none;
padding:10px 14px;
border-radius:10px;
cursor:pointer;
color:white;
font-weight:bold;
}

.empty{
text-align:center;
opacity:.7;
margin-top:50px;
font-size:18px;
}

</style>

</head>

<body>

<!-- HEADER -->

<div class="topbar">

<div class="back" onclick="history.back()">
‚¨Ö
</div>

<div class="pageTitle">
üì¶ My Orders
</div>

<a class="dashboard" href="dashboard.html">
Dashboard
</a>

</div>


<div class="container">

<div id="orders">
Loading Orders...
</div>

</div>


<script>

/* GOOGLE DRIVE API */

const API="https://script.google.com/macros/s/AKfycbw7xwjcEGIdj3xS8q7qhRNCSbch2uVsXFGFJYWgMNU4UPA-2BSfhq79PHsQ_oCEeYTm/exec";


/* LOGIN CHECK */

let user=JSON.parse(localStorage.getItem("user"));

if(!user){
alert("Login First");
location.href="login.html";
}


/* GET DATABASE */

async function getDB(db){
const res=await fetch(API+"?db="+db);
return await res.json();
}


/* LOAD ORDERS */

async function loadOrders(){

try{

let orders=await getDB("orders");

const box=document.getElementById("orders");

let myOrders=orders.filter(o=>o.user===user.email);

if(!myOrders.length){
box.innerHTML="<div class='empty'>üòÑ No Orders Yet</div>";
return;
}

box.innerHTML="";

myOrders.reverse().forEach(o=>{

let image=o.image||"https://picsum.photos/200";
let pdf=o.pdf||"#";

box.innerHTML+=`

<div class="card">

<img src="${image}" onerror="this.src='https://picsum.photos/200'">

<div class="details">

<div class="bookTitle">
${o.title||"Ebook"}
</div>

<div class="price">
‚Çπ ${o.price||0}
</div>

<div class="date">
Date : ${o.date||new Date().toLocaleDateString()}
</div>

<button class="download" onclick="openPDF('${pdf}')">
Download PDF üì•
</button>

</div>

</div>

`;

});

}catch(e){

document.getElementById("orders").innerHTML="‚ùå Orders Not Loading";

}

}

loadOrders();


/* OPEN PDF */

function openPDF(link){

if(!link||link=="#"){
alert("PDF Not Available");
return;
}

window.open(link,"_blank");

}

</script>

</body>

</html>
