<!DOCTYPE html>
<html>

<head>

<title>CreatorHub Admin Approval</title>

<meta name="viewport"
content="width=device-width,initial-scale=1">

<style>

body{
background:#020617;
color:white;
font-family:Arial;
padding:20px;
}

.card{
background:#111827;
padding:15px;
margin-top:15px;
border-radius:12px;
}

button{
padding:10px;
border:none;
margin-top:10px;
border-radius:8px;
cursor:pointer;
width:100%;
}

.approve{
background:#22c55e;
color:white;
}

.reject{
background:red;
color:white;
}

</style>

</head>

<body>

<h2>

üî• CreatorHub Admin Payment Approval

</h2>

<div id="list">

Loading...

</div>


<script>

/* ADMIN EMAIL */

const ADMIN=

"ayushprajpati6@gmail.com";


/* DRIVE API */

const API=

"https://script.google.com/macros/s/AKfycbzgKPuIAmuZWOfilOj8gM9qJcZesz3ECPIhpCvBmupKFY2t76_ObVWyylnoTa4ecyda/exec";


/* LOGIN CHECK */

let user=

JSON.parse(localStorage.getItem("user"));

if(!user || user.email!==ADMIN){

alert("Admin Only");

location.href="index.html";

}


/* DRIVE DB */

async function getDB(db){

let r=

await fetch(API+"?db="+db+"&t="+Date.now());

return await r.json();

}

async function saveDB(db,data){

await fetch(API,{

method:"POST",

headers:{

"Content-Type":"application/json"

},

body:JSON.stringify({db,data})

});

}


/* LOAD PAYMENT REQUEST */

async function loadRequests(){

let requests=

await getDB("paymentRequests")||[];


let html="";


let pending=

requests.filter(

r=>r.status==="pending"

);


if(!pending.length){

html="No Pending Requests";

}


pending.reverse()

.forEach((r)=>{


html+=`

<div class="card">

<h3>

${r.product.title}

</h3>

<p>

Buyer :

${r.buyer}

</p>

<p>

Price ‚Çπ${r.product.price}

</p>


<button class="approve"

onclick="approve('${r.id}')">

Approve ‚úÖ

</button>


<button class="reject"

onclick="reject('${r.id}')">

Reject ‚ùå

</button>

</div>

`;

});


document.getElementById("list").innerHTML=html;

}

loadRequests();



/* APPROVE PAYMENT */

async function approve(id){

let requests=

await getDB("paymentRequests")||[];


let r=

requests.find(x=>x.id===id);


if(!r)return;


r.status="approved";


/* LIBRARY ACCESS */

let library=

await getDB("library")||[];


library.push({

buyer:r.buyer,

product:r.product,

date:new Date().toLocaleString()

});


await saveDB("library",library);

await saveDB("paymentRequests",requests);


alert("Approved ‚úÖ Buyer Library Updated");

loadRequests();

}



/* REJECT */

async function reject(id){

let requests=

await getDB("paymentRequests")||[];

let r=

requests.find(x=>x.id===id);

if(!r)return;


r.status="rejected";

await saveDB(

"paymentRequests",

requests

);

alert("Rejected");

loadRequests();

}

</script>

</body>

</html>
