<script>

const API="https://creatorhub-f2fe.onrender.com/api";


async function loadProducts(){

let html="";


// SERVER PRODUCTS

try{

const res=await fetch(API+"/products");

const data=await res.json();

data.products.forEach(p=>{

html+=`

<div class="card">

<img src="${p.image}"

onclick="openProduct('${p._id}')">

<h3>${p.title}</h3>

<p>₹${p.price}</p>


<button class="buy"

onclick="buyNow('${p._id}')">

Buy Ebook

</button>


<button class="cart"

onclick='addCart(${JSON.stringify(p)})'>

Add Cart

</button>

</div>

`;

});

}catch(e){

console.log("API ERROR");

}



// LOCAL UPLOADED PRODUCTS ⭐⭐⭐

let myProducts=

JSON.parse(

localStorage.getItem("myProducts")

)||[];


myProducts.reverse().forEach((p,i)=>{

html+=`

<div class="card">

<img src="${p.image}"

onclick="openLocal(${i})">

<h3>${p.title}</h3>

<p>₹${p.price}</p>


<button class="buy"

onclick="buyLocal(${i})">

Buy Ebook

</button>


<button class="cart"

onclick="addLocalCart(${i})">

Add Cart

</button>

</div>

`;

});


document.getElementById("products")

.innerHTML=html;

}

loadProducts();



// OPEN

function openProduct(id){

location.href="product.html?id="+id;

}


function openLocal(i){

alert("Local Ebook");

}



// BUY API PRODUCT

function buyNow(id){

localStorage.setItem(

"buyProduct",id

);

location.href="payment.html";

}



// BUY LOCAL PRODUCT ⭐⭐⭐

function buyLocal(i){

localStorage.setItem(

"buyLocal",i

);

location.href="payment.html";

}



// CART API

function addCart(p){

let cart=

JSON.parse(

localStorage.getItem("cart")

)||[];

cart.push(p);

localStorage.setItem(

"cart",

JSON.stringify(cart)

);

alert("Added To Cart");

}



// CART LOCAL

function addLocalCart(i){

let myProducts=

JSON.parse(

localStorage.getItem("myProducts")

)||[];

let cart=

JSON.parse(

localStorage.getItem("cart")

)||[];

cart.push(myProducts[i]);

localStorage.setItem(

"cart",

JSON.stringify(cart)

);

alert("Added To Cart");

}

</script>
