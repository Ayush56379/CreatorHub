<!DOCTYPE html>

<html>

<head>

<title>Products</title>

</head>

<body>

<h2>

ðŸ›’ All Products

</h2>

<div id="products">

Loading...

</div>

<br>

<a href="index.html">

Home

</a>


<script>

const API_URL =
"https://creatorhub-f2fe.onrender.com/api";


// ===== LOAD PRODUCTS =====

async function loadProducts(){

const res =
await fetch(

API_URL + "/products"

);

const data =
await res.json();

const box =
document.getElementById(

"products"

);


if(

!data.products ||

data.products.length===0

){

box.innerHTML=

"No Products Found";

return;

}


box.innerHTML="";


data.products.forEach(

product=>{

box.innerHTML += `

<hr>

<h3>

${product.title}

</h3>

<p>

â‚¹${product.price}

</p>

<img

src="${product.image}"

width="200"

>

<br><br>

<button onclick="buyProduct(

'${product._id}'

)">

Buy Now

</button>

`;

}

);

}


// ===== BUY PRODUCT =====

async function buyProduct(id){

const token =
localStorage.getItem(

"token"

);

if(!token){

alert(

"Login First"

);

window.location.href=

"login.html";

return;

}


const res =
await fetch(

API_URL +

"/orders/buy",

{

method:"POST",

headers:{

"Content-Type":

"application/json",

Authorization:

"Bearer "+token

},

body:JSON.stringify({

productId:id

})

});

const data =
await res.json();


if(data.success){

alert(

"Order Success ðŸŽ‰"

);

}else{

alert(

data.message

);

}

}


loadProducts();

</script>

</body>

</html>
