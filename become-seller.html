<script>

const API =
"https://script.google.com/macros/s/AKfycbw7xwjcEGIdj3xS8q7qhRNCSbch2uVsXFGFJYWgMNU4UPA-2BSfhq79PHsQ_oCEeYTm/exec";

let user =
JSON.parse(localStorage.getItem("user"));

if(!user){

alert("Login First");

location.href="login.html";

}


// LOAD DB

async function getDB(db){

let res =
await fetch(API+"?db="+db);

let data =
await res.json();


// ⭐ अगर DB empty हो

if(!Array.isArray(data)){

return [];

}

return data;

}


// SAVE DB

async function saveDB(db,data){

await fetch(API,{

method:"POST",

body:JSON.stringify({

db:db,

data:data

})

});

}


// APPLY SELLER ⭐⭐⭐⭐⭐

async function applySeller(){

try{

let users =
await getDB("users");


// USER SEARCH

let found =
users.find(
u=>u.email===user.email
);


// ⭐ USER NOT FOUND AUTO CREATE ⭐

if(!found){

users.push({

email:user.email,

role:"seller",

banned:false,

created:
new Date().toLocaleString()

});

}else{

found.role="seller";

}


// SAVE

await saveDB(

"users",

users

);


// LOCAL SAVE

user.role="seller";

localStorage.setItem(

"user",

JSON.stringify(user)

);


alert("✅ Seller Activated");

location.href="dashboard.html";


}catch(e){

console.log(e);

alert("Server Error");

}

}

</script>
