<!DOCTYPE html>
<html lang="en">

<head>

<meta charset="UTF-8">

<meta name="viewport"
content="width=device-width,initial-scale=1">

<title>CreatorHub Admin Panel</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>

/* AUTO THEME */

:root{

--bg:#ffffff;
--text:#111827;
--card:#f3f4f6;
--accent:#22c55e;

}

@media (prefers-color-scheme:dark){

:root{

--bg:#020617;
--text:#ffffff;
--card:#111827;

}

}

body{

margin:0;

font-family:Arial;

background:var(--bg);

color:var(--text);

}


/* HEADER */

.topbar{

display:flex;

align-items:center;

padding:14px;

background:var(--bg);

box-shadow:0 5px 20px rgba(0,0,0,.3);

position:sticky;

top:0;

z-index:99;

}

.back{

font-size:22px;

cursor:pointer;

width:40px;

}

.title{

flex:1;

text-align:center;

font-weight:bold;

font-size:19px;

color:var(--accent);

}


/* CONTAINER */

.container{

max-width:1100px;

margin:auto;

padding:20px;

}


/* CARD */

.card{

background:var(--card);

padding:20px;

border-radius:15px;

margin-bottom:20px;

box-shadow:

0 10px 20px rgba(0,0,0,.2);

}


/* ROW */

.row{

display:flex;

justify-content:space-between;

align-items:center;

margin-top:10px;

padding:12px;

background:rgba(0,0,0,.08);

border-radius:10px;

flex-wrap:wrap;

gap:10px;

}


/* BUTTON */

button{

border:none;

padding:7px 12px;

border-radius:8px;

cursor:pointer;

color:white;

}

.edit{background:orange;}

.delete{background:red;}

.approve{background:#22c55e;}

.reject{background:#ef4444;}

.ban{background:#ef4444;}

.badge{

background:#22c55e;

padding:3px 6px;

border-radius:6px;

font-size:12px;

margin-left:6px;

}


/* PROFIT */

.big{

font-size:28px;

color:#22c55e;

font-weight:bold;

}

canvas{

background:rgba(0,0,0,.08);

border-radius:10px;

padding:10px;

}

</style>

</head>

<body>


<div class="topbar">

<div class="back"

onclick="history.back()">

‚¨Ö

</div>

<div class="title">

üî• CreatorHub Admin

</div>

</div>


<div class="container">


<!-- PROFIT -->

<div class="card">

<h2>

üí∞ Owner Profit

</h2>

‚Çπ

<span id="profit"

class="big">

0

</span>

</div>



<!-- GRAPH -->

<div class="card">

<h2>

üìä Earnings Analytics

</h2>

<canvas id="chart">

</canvas>

</div>



<!-- PRODUCTS -->

<div class="card">

<h2>

üì¶ Product Approval

</h2>

<div id="products">

Loading...

</div>

</div>



<!-- SELLERS -->

<div class="card">

<h2>

üö´ Seller Control

</h2>

<div id="sellers">

Loading...

</div>

</div>



<!-- WITHDRAW -->

<div class="card">

<h2>

üè¶ Withdraw Requests

</h2>

<div id="withdraws">

Loading...

</div>

</div>


</div>



<script>

/* ADMIN EMAIL */

const ADMIN="ayushprajpati6@gmail.com";


const API=

"https://script.google.com/macros/s/AKfycbw7xwjcEGIdj3xS8q7qhRNCSbch2uVsXFGFJYWgMNU4UPA-2BSfhq79PHsQ_oCEeYTm/exec";


let user=

JSON.parse(localStorage.getItem("user"));


if(!user||

user.email!==ADMIN){

alert("Admin Only");

location.href="index.html";

}


/* DRIVE */

async function getDB(db){

let r=

await fetch(API+"?db="+db);

return await r.json();

}


async function saveDB(db,data){

await fetch(API,{

method:"POST",

body:JSON.stringify({

db,data

})

});

}



/* PRODUCTS */

async function loadProducts(){

let products=

await getDB("products");

let box=

document.getElementById("products");

box.innerHTML="";


products.reverse()

.forEach(p=>{


box.innerHTML+=`

<div class="row">

<div>

<b>

${p.title}

</b>

‚Çπ${p.price}

${p.status==="pending"

?'<span class="badge">Pending</span>'

:""

}

</div>


<div>

<button

class="edit"

onclick="editProduct('${p.id}')">

Edit

</button>


<button

class="delete"

onclick="deleteProduct('${p.id}')">

Delete

</button>


${

p.status==="pending"

?

`<button

class="approve"

onclick="approveProduct('${p.id}')">

Approve

</button>

<button

class="reject"

onclick="rejectProduct('${p.id}')">

Reject

</button>`

:""

}

</div>

</div>

`;

});

}


async function approveProduct(id){

let products=

await getDB("products");


products=

products.map(p=>{

if(p.id==id){

p.status="approved";

}

return p;

});


await saveDB("products",products);

loadProducts();

}


async function rejectProduct(id){

let products=

await getDB("products");


products=

products.filter(

p=>p.id!=id

);


await saveDB("products",products);

loadProducts();

}


async function deleteProduct(id){

let products=

await getDB("products");


products=

products.filter(

p=>p.id!=id

);


await saveDB(

"products",

products

);

loadProducts();

}


async function editProduct(id){

let title=

prompt("New Title");

let price=

prompt("New Price");


let products=

await getDB("products");


products=

products.map(p=>{

if(p.id==id){

p.title=title||p.title;

p.price=price||p.price;

}

return p;

});


await saveDB("products",products);

loadProducts();

}



/* SELLERS */

async function loadSellers(){

let users=

await getDB("users");

let box=

document.getElementById("sellers");

box.innerHTML="";


users.forEach(u=>{

box.innerHTML+=`

<div class="row">

${u.email}

<button

class="ban"

onclick="banUser('${u.email}')">

Ban

</button>

</div>

`;

});

}


async function banUser(email){

let users=

await getDB("users");


users=

users.map(u=>{

if(u.email==email){

u.banned=true;

}

return u;

});


await saveDB(

"users",

users

);

alert("Seller Banned");

loadSellers();

}



/* WITHDRAW */

async function loadWithdraws(){

let withdraws=

await getDB("withdraws");

let box=

document.getElementById("withdraws");

box.innerHTML="";


withdraws.reverse()

.forEach(w=>{

box.innerHTML+=`

<div class="row">

<div>

${w.user}

‚Çπ${w.amount}

<br>

UPI :

${w.upi}

</div>


<button

class="approve"

onclick="approveWithdraw(

'${w.time}',

'${w.amount}',

'${w.user}'

)">

Approve

</button>

</div>

`;

});

}


function whatsapp(user,amount){

let msg=

encodeURIComponent(

"Withdraw Approved ‚úÖ%0AUser:"+user+

"%0AAmount ‚Çπ"+amount

);

window.open(

"https://wa.me/?text="+msg

);

}


async function approveWithdraw(

time,

amount,

userEmail

){

let withdraws=

await getDB("withdraws");


withdraws=

withdraws.map(w=>{

if(w.time==time){

w.status="Approved";

}

return w;

});


await saveDB(

"withdraws",

withdraws

);

whatsapp(

userEmail,

amount

);

alert("Approved");

loadWithdraws();

}



/* PROFIT */

async function loadProfit(){

let orders=

await getDB("orders");

let total=0;


orders.forEach(o=>{

total+=

o.price*.20;

});


document.getElementById("profit")

.innerText=

Math.floor(total);


new Chart(

document.getElementById("chart"),

{

type:"line",

data:{

labels:

orders.map(

(_,i)=>"Order "+(i+1)

),

datasets:[{

label:

"Owner Profit",

data:

orders.map(

o=>o.price*.20

),

borderWidth:3

}]

}

});

}



/* LOAD */

loadProducts();

loadSellers();

loadWithdraws();

loadProfit();

</script>

</body>

</html>
