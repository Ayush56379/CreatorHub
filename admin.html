<!DOCTYPE html>
<html>

<head>

<meta name="viewport" content="width=device-width,initial-scale=1">

<title>CreatorHub SUPER ADMIN</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>

body{
margin:0;
font-family:Arial;
background:#020617;
color:white;
}

.topbar{
display:flex;
align-items:center;
padding:14px;
background:#020617;
box-shadow:0 5px 20px black;
}

.back{
font-size:22px;
cursor:pointer;
width:40px;
}

.title{
flex:1;
text-align:center;
color:#22c55e;
font-weight:bold;
}

.container{
max-width:1100px;
margin:auto;
padding:20px;
}

.card{
background:#111827;
padding:20px;
border-radius:15px;
margin-bottom:20px;
}

.row{
background:#020617;
padding:12px;
border-radius:10px;
margin-top:10px;
}

button{
border:none;
padding:8px 12px;
border-radius:8px;
cursor:pointer;
color:white;
margin:4px;
}

.edit{background:orange;}
.delete{background:red;}
.approve{background:#22c55e;}
.reject{background:#ef4444;}
.ban{background:red;}

.big{
font-size:28px;
color:#22c55e;
}

</style>

</head>

<body>

<div class="topbar">

<div class="back"
onclick="history.back()">

‚¨Ö

</div>

<div class="title">

üî• CreatorHub SUPER ADMIN

</div>

</div>

<div class="container">

<div class="card">

<h2>üí∞ Owner Profit</h2>

‚Çπ <span id="profit" class="big">

0

</span>

</div>


<div class="card">

<h2>üì¶ Product Control</h2>

<div id="products">

Loading...

</div>

</div>


<div class="card">

<h2>üë§ USER WALLET BALANCE</h2>

<div id="wallets">

Loading...

</div>

</div>


<div class="card">

<h2>üö´ Seller Control</h2>

<div id="sellers">

Loading...

</div>

</div>


<div class="card">

<h2>üè¶ Withdraw Requests</h2>

<div id="withdraws">

Loading...

</div>

</div>

</div>


<script>

/* ADMIN EMAIL */

const ADMIN="ayushprajpati6@gmail.com";

/* YOUR API */

const API="https://script.google.com/macros/s/AKfycbzgKPuIAmuZWOfilOj8gM9qJcZesz3ECPIhpCvBmupKFY2t76_ObVWyylnoTa4ecyda/exec";


let user=

JSON.parse(

localStorage.getItem("user")

);

if(!user||

user.email!==ADMIN){

alert("Admin Only");

location.href="index.html";

}


/* SAFE API LOAD */

async function getDB(db){

try{

let r=

await fetch(

API+"?db="+db+"&t="+Date.now()

);

let text=

await r.text();

if(!text)return[];

let data=

JSON.parse(text);

return Array.isArray(data)

?data:[];

}catch(e){

console.log("API ERROR",e);

return[];

}

}


async function saveDB(db,data){

await fetch(API,{

method:"POST",

headers:{

"Content-Type":"text/plain"

},

body:JSON.stringify({

db:db,

data:data

})

});

}


/* PRODUCTS */

async function loadProducts(){

let products=

await getDB("products");

let box=

document.getElementById(

"products"

);

box.innerHTML="";


products.reverse()

.forEach(p=>{

box.innerHTML+=`

<div class="row">

<b>${p.title}</b>

‚Çπ${p.price}

<br>

Seller :

${p.owner}

<br>

Status :

${p.status}

<br>

<button class="edit"

onclick="editProduct('${p.id}')">

Edit

</button>

<button class="delete"

onclick="deleteProduct('${p.id}')">

Delete

</button>

<button class="approve"

onclick="approve('${p.id}')">

Approve

</button>

<button class="reject"

onclick="reject('${p.id}')">

Reject

</button>

</div>

`;

});

}


async function editProduct(id){

let title=

prompt("New Title");

let price=

prompt("New Price");

let seller=

prompt("New Seller Email");


let products=

await getDB("products");


products=

products.map(p=>{

if(p.id==id){

if(title)

p.title=title;

if(price)

p.price=

Number(price);

if(seller)

p.owner=seller;

}

return p;

});


await saveDB(

"products",

products

);

alert("Updated");

loadProducts();

}


async function deleteProduct(id){

if(!confirm(

"Delete Ebook?"

))

return;


let products=

await getDB("products");


products=

products.filter(

p=>p.id!=id

);


await saveDB(

"products",

products

);

loadProducts();

}


async function approve(id){

let products=

await getDB("products");


products.map(p=>{

if(p.id==id)

p.status=

"approved";

});


await saveDB(

"products",

products

);

loadProducts();

}


async function reject(id){

deleteProduct(id);

}


/* USER WALLET */

async function loadWallets(){

let wallets=

await getDB("wallet");

let box=

document.getElementById(

"wallets"

);

box.innerHTML="";


wallets.forEach(w=>{

box.innerHTML+=`

<div class="row">

${w.email}

<br>

Balance ‚Çπ${w.balance}

</div>

`;

});

}


/* SELLERS */

async function loadSellers(){

let users=

await getDB("users");

let box=

document.getElementById(

"sellers"

);

box.innerHTML="";


users.forEach(u=>{

box.innerHTML+=`

<div class="row">

${u.email}

${u.banned?

" (Banned)"

:""}

<button class="ban"

onclick="banUser('${u.email}')">

Ban

</button>

</div>

`;

});

}


async function banUser(email){

let users=

await getDB("users");


users.map(u=>{

if(u.email==email)

u.banned=true;

});


await saveDB(

"users",

users

);

alert("User Banned");

loadSellers();

}


/* WITHDRAW */

async function loadWithdraw(){

let withdraw=

await getDB("withdraw");

let box=

document.getElementById(

"withdraws"

);

box.innerHTML="";


withdraw.forEach(w=>{

if(

w.status==="Approved"

)return;


box.innerHTML+=`

<div class="row">

${w.email}

‚Çπ${w.requestAmount}

<br>

UPI :

${w.upi}

<button class="approve"

onclick="approveWithdraw('${w.date}')">

Approve

</button>

</div>

`;

});

}


async function approveWithdraw(date){

let withdraw=

await getDB("withdraw");


withdraw.map(w=>{

if(w.date==date)

w.status=

"Approved";

});


await saveDB(

"withdraw",

withdraw

);

alert(

"Withdraw Approved"

);

loadWithdraw();

}


/* PROFIT */

async function profit(){

let orders=

await getDB("orders");

let total=0;

orders.forEach(o=>{

total+=

o.amount*

0.20;

});


document.getElementById(

"profit"

).innerText=

Math.floor(total);

}


/* LOAD ALL */

loadProducts();

loadWallets();

loadSellers();

loadWithdraw();

profit();

</script>

</body>

</html>
