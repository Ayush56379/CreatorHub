<!DOCTYPE html>
<html>

<head>

<meta name="viewport"
content="width=device-width,initial-scale=1">

<title>CreatorHub SUPER ADMIN</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>

body{
margin:0;
font-family:Arial;
background:#020617;
color:white;
}

.topbar{
display:flex;
align-items:center;
padding:14px;
background:#020617;
box-shadow:0 5px 20px black;
}

.back{
font-size:22px;
cursor:pointer;
width:40px;
}

.title{
flex:1;
text-align:center;
color:#22c55e;
font-weight:bold;
}

.container{
max-width:1100px;
margin:auto;
padding:20px;
}

.card{
background:#111827;
padding:20px;
border-radius:15px;
margin-bottom:20px;
}

.row{
background:#020617;
padding:12px;
border-radius:10px;
margin-top:10px;
}

button{
border:none;
padding:8px 12px;
border-radius:8px;
cursor:pointer;
color:white;
margin:4px;
}

.edit{background:orange;}
.delete{background:red;}
.approve{background:#22c55e;}
.reject{background:#ef4444;}
.ban{background:red;}

input{
width:100%;
padding:12px;
margin-top:10px;
border:none;
border-radius:8px;
background:#020617;
color:white;
}

.big{
font-size:28px;
color:#22c55e;
}

/* popup */

#editBox{

display:none;
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,.8);
overflow:auto;

}

.editContent{

background:#111827;
max-width:500px;
margin:40px auto;
padding:20px;
border-radius:12px;

}

</style>

</head>

<body>

<div class="topbar">

<div class="back"
onclick="history.back()">

â¬…

</div>

<div class="title">

ðŸ”¥ CreatorHub SUPER ADMIN

</div>

</div>


<div class="container">

<div class="card">

<h2>Owner Profit</h2>

â‚¹ <span id="profit" class="big">0</span>

</div>


<div class="card">

<h2>Product Control</h2>

<div id="products">

Loading...

</div>

</div>


<div class="card">

<h2>USER WALLET BALANCE</h2>

<div id="wallets">

Loading...

</div>

</div>


<div class="card">

<h2>Seller Control</h2>

<div id="sellers">

Loading...

</div>

</div>


<div class="card">

<h2>Withdraw Requests</h2>

<div id="withdraws">

Loading...

</div>

</div>

</div>


<!-- EDIT -->

<div id="editBox">

<div class="editContent">

<h3>Edit Ebook</h3>

<input id="eTitle">

<input id="ePrice" type="number">

<input id="eSeller">

<p>Change Cover</p>

<input type="file" id="cover">

<p>Change PDF</p>

<input type="file" id="pdf">

<button class="approve"
onclick="saveEdit()">

Save Changes

</button>

<button class="delete"
onclick="deleteEdit()">

Delete Ebook

</button>

<button onclick="closeEdit()">

Cancel

</button>

</div>

</div>

<script>

const ADMIN="ayushprajpati6@gmail.com";

const API="https://script.google.com/macros/s/AKfycbzgKPuIAmuZWOfilOj8gM9qJcZesz3ECPIhpCvBmupKFY2t76_ObVWyylnoTa4ecyda/exec";

let user=
JSON.parse(localStorage.getItem("user"));

if(!user||user.email!==ADMIN){

alert("Admin Only");

location.href="index.html";

}

async function getDB(db){

let r=
await fetch(API+"?db="+db+"&t="+Date.now());

return await r.json();

}

async function saveDB(db,data){

await fetch(API,{

method:"POST",

headers:{
"Content-Type":"application/json"
},

body:
JSON.stringify({db,data})

});

}


/* PRODUCT */

let editID=null;

async function loadProducts(){

let products=
await getDB("products")||[];

let box=
document.getElementById("products");

box.innerHTML="";

products.reverse().forEach(p=>{

box.innerHTML+=`

<div class="row">

<b>${p.title}</b>

â‚¹${p.price}

<br>

Seller :

${p.owner}

<br>

Status :

${p.status}

<br>

<button class="edit"

onclick="openEdit('${p.id}')">

Edit

</button>

<button class="delete"

onclick="deleteProduct('${p.id}')">

Delete

</button>

${p.status!="approved"?

`<button class="approve"

onclick="approve('${p.id}')">

Approve

</button>`:""}

<button class="reject"

onclick="reject('${p.id}')">

Reject

</button>

</div>

`;

});

}


async function openEdit(id){

editID=id;

let products=
await getDB("products");

let p=
products.find(x=>x.id==id);

eTitle.value=p.title;

ePrice.value=p.price;

eSeller.value=p.owner;

editBox.style.display="block";

}

function closeEdit(){

editBox.style.display="none";

}


async function saveEdit(){

let products=
await getDB("products");

products=
products.map(p=>{

if(p.id==editID){

p.title=eTitle.value;

p.price=
Number(ePrice.value);

p.owner=eSeller.value;

}

return p;

});

await saveDB(

"products",

products

);

alert("Saved");

closeEdit();

loadProducts();

}

async function deleteEdit(){

deleteProduct(editID);

closeEdit();

}

async function deleteProduct(id){
