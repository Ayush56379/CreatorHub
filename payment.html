<!DOCTYPE html>
<html>

<head>

<meta name="viewport"
content="width=device-width,initial-scale=1">

<title>Payment</title>

<style>

body{
background:#020617;
color:white;
font-family:Arial;
padding:20px;
}

.card{

background:#111827;

padding:20px;

border-radius:15px;

}

img{

width:100%;

height:200px;

object-fit:cover;

border-radius:12px;

}

button{

width:100%;

padding:15px;

margin-top:15px;

border:none;

border-radius:10px;

font-size:17px;

cursor:pointer;

}

.pay{

background:#22c55e;

}

.done{

background:orange;

}

</style>

</head>

<body>

<h2>üí≥ Buy Ebook</h2>

<div class="card">

<img id="image">

<h3 id="title"></h3>

‚Çπ <span id="price"></span>

<button
class="pay"
onclick="payNow()">

Pay With UPI üöÄ

</button>

<button
class="done"
onclick="confirmPayment()">

I Have Paid ‚úÖ

</button>

</div>



<script>

/* YOUR DRIVE API */

const API=
"https://script.google.com/macros/s/AKfycbzgKPuIAmuZWOfilOj8gM9qJcZesz3ECPIhpCvBmupKFY2t76_ObVWyylnoTa4ecyda/exec";


let id=
localStorage.getItem(
"buyProduct"
);

let user=
JSON.parse(
localStorage.getItem("user")
)||{email:"guest"};


/* DRIVE IMAGE FIX */

function driveImage(link){

if(!link)
return "https://picsum.photos/400";

let fileId=
link.split("id=")[1];

return "https://drive.google.com/thumbnail?id="+fileId+"&sz=w800";

}


/* GET DB */

async function getDB(db){

let r=
await fetch(API+"?db="+db);

return await r.json();

}


/* SAVE DB */

async function saveDB(db,data){

await fetch(API,{

method:"POST",

headers:{
"Content-Type":"application/json"
},

body:JSON.stringify({

db:db,

data:data

})

});

}


/* LOAD PRODUCT */

let product;

async function load(){

let products=
await getDB("products");

product=
products.find(

p=>String(p.id)===id

);

if(!product){

alert("Not Found");

return;

}

image.src=
driveImage(product.image);

title.innerText=
product.title;

price.innerText=
product.price;

}

load();


/* ‚≠ê PAYMENT OPEN ‚≠ê */

function payNow(){

let upiId=
"yourupi@okaxis";   // CHANGE

let name=
"CreatorHub";

let amount=
product.price;

let note=
encodeURIComponent(
product.title
);

let link=

`upi://pay?pa=${upiId}&pn=${name}&am=${amount}&cu=INR&tn=${note}`;


/* OPEN PAYMENT APP */

window.location.href=link;

}



/* SAVE ORDER */

async function confirmPayment(){

let orders=
await getDB("orders")||[];


orders.push({

id:Date.now(),

product:product.id,

buyer:user.email,

amount:product.price,

status:"paid",

date:new Date().toLocaleString()

});


await saveDB(

"orders",

orders

);

alert("Payment Saved ‚úÖ");

location.href="orders.html";

}

</script>

</body>

</html>
