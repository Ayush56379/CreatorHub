<!DOCTYPE html>
<html>

<head>

<title>Cart - CreatorHub</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<style>

body{
font-family:Arial;
background:#111;
color:white;
margin:0;
}

/* NAVBAR */

nav{
background:black;
padding:15px;
display:flex;
align-items:center;
justify-content:space-between;
}

.left{
display:flex;
align-items:center;
gap:10px;
}

.back{
font-size:22px;
cursor:pointer;
}

nav a{
color:#22c55e;
text-decoration:none;
}

/* CONTAINER */

.container{
padding:20px;
}

.card{
background:#222;
display:flex;
gap:15px;
margin-bottom:15px;
padding:15px;
border-radius:10px;
align-items:center;
}

.card img{
width:80px;
height:80px;
object-fit:cover;
border-radius:8px;
}

.info{
flex:1;
}

.qty{
display:flex;
gap:10px;
margin-top:10px;
align-items:center;
flex-wrap:wrap;
}

button{
background:orange;
border:none;
padding:8px 12px;
cursor:pointer;
border-radius:6px;
}

.total{
background:black;
padding:15px;
border-radius:10px;
margin-top:20px;
}

</style>

</head>

<body>


<!-- NAV -->

<nav>

<div class="left">

<div class="back"
onclick="history.back()">

â¬…

</div>

ðŸ›’ CreatorHub Cart

</div>

<a href="dashboard.html">
Dashboard
</a>

</nav>


<div class="container">

<h2>Your Cart</h2>

<div id="cart">Loading...</div>

<div id="totalBox"
class="total"
style="display:none">

Total â‚¹ :
<span id="total">0</span>

<button
onclick="placeOrder()"
style="width:100%;margin-top:10px">

ðŸ”¥ Buy All

</button>

</div>

</div>


<script>

/* DRIVE IMAGE FIX */

function driveImage(link){

if(!link)
return "https://picsum.photos/200";

try{

let id="";

if(link.includes("id=")){
id=link.split("id=")[1].split("&")[0];
}
else if(link.includes("/file/d/")){
id=link.split("/file/d/")[1].split("/")[0];
}

if(id){

return "https://drive.google.com/thumbnail?id="+id+"&sz=w500";

}

}catch(e){}

return link;

}


/* LOAD CART */

let cart=
JSON.parse(
localStorage.getItem("cart")
)||[];


/* REMOVE DUPLICATE */

function uniqueCart(){

let map={};

cart.forEach(p=>{

if(!map[p.id]){

map[p.id]={...p,qty:1};

}else{

map[p.id].qty++;

}

});

cart=Object.values(map);

localStorage.setItem(
"cart",
JSON.stringify(cart)
);

}

uniqueCart();


function loadCart(){

let html="";
let total=0;

if(cart.length===0){

html="<h3>Cart Empty</h3>";

document.getElementById(
"totalBox"
).style.display="none";

}else{

cart.forEach((p,i)=>{

total+=p.price*p.qty;

html+=`

<div class="card">

<img
src="${driveImage(p.image)}"
onerror="this.src='https://picsum.photos/200'">

<div class="info">

<h3>${p.title}</h3>

â‚¹${p.price}

<div class="qty">

<button onclick="minus(${i})">
-
</button>

Qty : ${p.qty}

<button onclick="plus(${i})">
+
</button>

<button onclick="removeItem(${i})">
Remove
</button>

</div>

</div>

</div>

`;

});

document.getElementById(
"total"
).innerText=total;

document.getElementById(
"totalBox"
).style.display="block";

}

document.getElementById(
"cart"
).innerHTML=html;

}


function plus(i){

cart[i].qty++;

save();

}

function minus(i){

if(cart[i].qty>1){

cart[i].qty--;

}else{

cart.splice(i,1);

}

save();

}

function removeItem(i){

cart.splice(i,1);

save();

}

function save(){

localStorage.setItem(
"cart",
JSON.stringify(cart)
);

loadCart();

}


/* ORDER */

function placeOrder(){

if(cart.length===0){

alert("Cart Empty");

return;

}

localStorage.setItem(
"buyProduct",
"cart"
);

location.href="payment.html";

}


loadCart();

</script>

</body>

</html>
