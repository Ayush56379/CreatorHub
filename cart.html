<!DOCTYPE html>
<html>

<head>

<title>Cart - CreatorHub</title>

<meta name="viewport" content="width=device-width,initial-scale=1">

<style>

body{
font-family:Arial;
background:#111;
color:white;
margin:0;
}

nav{
background:black;
padding:15px;
display:flex;
justify-content:space-between;
}

.container{
padding:20px;
}

.card{

background:#222;

display:flex;

gap:15px;

margin-bottom:15px;

padding:15px;

border-radius:10px;

align-items:center;

}

img{

width:80px;
height:80px;

object-fit:cover;

border-radius:8px;

}

.info{
flex:1;
}

.qty{

display:flex;

gap:10px;

margin-top:10px;

}

button{

background:orange;

border:none;

padding:8px 12px;

cursor:pointer;

border-radius:6px;

}

.total{

background:black;

padding:15px;

border-radius:10px;

margin-top:20px;

}

</style>

</head>

<body>

<nav>

ðŸ›’ CreatorHub Cart

<a href="dashboard.html">

Dashboard

</a>

</nav>


<div class="container">

<h2>Your Cart</h2>

<div id="cart">

Loading...

</div>


<div id="totalBox"

class="total"

style="display:none">

Total â‚¹ :

<span id="total">

0

</span>


<button onclick="placeOrder()"

style="width:100%">

ðŸ”¥ Buy All

</button>

</div>


</div>



<script>

const API=

"https://creatorhub-f2fe.onrender.com/api";


// CART LOAD

let cart=

JSON.parse(

localStorage.getItem("cart")

)||[];



// â­ DUPLICATE REMOVE

function uniqueCart(){

let map={};

cart.forEach(p=>{

if(!map[p._id]){

map[p._id]={

...p,

qty:1

};

}else{

map[p._id].qty++;

}

});

cart=Object.values(map);

localStorage.setItem(

"cart",

JSON.stringify(cart)

);

}

uniqueCart();



// LOAD

function loadCart(){

let html="";

let total=0;


if(cart.length===0){

html="<h3>Cart Empty</h3>";

document.getElementById(

"totalBox"

).style.display="none";

}else{


cart.forEach((p,i)=>{


total+=

(p.price*p.qty);


html+=`

<div class="card">

<img src="${p.image ||

'https://picsum.photos/200'

}">


<div class="info">

<h3>

${p.title}

</h3>


â‚¹${p.price}


<div class="qty">

<button onclick="minus(${i})">

-

</button>

Qty :

${p.qty}

<button onclick="plus(${i})">

+

</button>


<button onclick="removeItem(${i})">

Remove

</button>

</div>


</div>

</div>

`;

});


document.getElementById(

"total"

).innerText=total;

document.getElementById(

"totalBox"

).style.display="block";

}


document.getElementById(

"cart"

).innerHTML=html;

}



function plus(i){

cart[i].qty++;

save();

}



function minus(i){

if(cart[i].qty>1){

cart[i].qty--;

}else{

cart.splice(i,1);

}

save();

}



function removeItem(i){

cart.splice(i,1);

save();

}


function save(){

localStorage.setItem(

"cart",

JSON.stringify(cart)

);

loadCart();

}



async function placeOrder(){

const token=

localStorage.getItem("token");


if(!token){

alert("Login First");

location.href="login.html";

return;

}


try{


for(let product of cart){

await fetch(

API+"/orders",

{

method:"POST",

headers:{

"Content-Type":

"application/json",

Authorization:

"Bearer "+token

},

body:JSON.stringify({

productId:

product._id

})

});

}


localStorage.removeItem(

"cart"

);

alert("Order Placed");

location.href="orders.html";

}

catch{

alert("Failed");

}

}


loadCart();

</script>

</body>

</html>
