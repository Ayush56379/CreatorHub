<!DOCTYPE html>
<html>

<head>

<title>Cart - CreatorHub</title>

<meta name="viewport" content="width=device-width,initial-scale=1">

<style>

body{
font-family:Arial;
background:#111;
color:white;
margin:0;
}

nav{
background:black;
padding:15px;
display:flex;
justify-content:space-between;
}

.back{
background:#222;
padding:10px;
text-align:center;
cursor:pointer;
}

.container{
padding:20px;
}

.card{

background:#222;

padding:15px;

margin-bottom:15px;

border-radius:10px;

display:flex;

gap:15px;

align-items:center;

}

.card img{

width:90px;

height:90px;

object-fit:cover;

border-radius:10px;

}

.info{

flex:1;

}

.qty{

display:flex;

gap:8px;

margin-top:10px;

}

.qty button{

background:#333;

color:white;

border:none;

padding:6px 10px;

cursor:pointer;

}

.remove{

background:red;

margin-top:8px;

}

.total{

background:#000;

padding:15px;

border-radius:10px;

margin-top:20px;

}

.order{

width:100%;

margin-top:10px;

background:orange;

padding:12px;

font-weight:bold;

border:none;

cursor:pointer;

}

.empty{

text-align:center;

opacity:.7;

}

</style>

</head>

<body>


<nav>

<div>

üõí CreatorHub Cart

</div>

<a href="dashboard.html"

style="color:white">

Dashboard

</a>

</nav>



<div class="back"

onclick="history.back()">

‚¨Ö Back

</div>



<div class="container">


<h2>

Your Cart

</h2>


<div id="cart">

Loading...

</div>


<div id="totalBox"

class="total"

style="display:none">

<h3>

Total ‚Çπ :

<span id="total">

0

</span>

</h3>


<button

class="order"

onclick="placeOrder()">

üî• Buy All Products

</button>

</div>


</div>



<script>

const API="https://creatorhub-f2fe.onrender.com/api";



// LOAD CART

function loadCart(){

let cart=

JSON.parse(

localStorage.getItem("cart")

)||[];


let html="";

let total=0;


// EMPTY

if(cart.length===0){

document.getElementById("cart")

.innerHTML=`

<div class="empty">

<h3>Cart Empty üõí</h3>

</div>

`;

document.getElementById("totalBox")

.style.display="none";

return;

}


cart.forEach((p,i)=>{


// qty default

if(!p.qty)p.qty=1;


total +=

(Number(p.price)||0)

* p.qty;


html+=`

<div class="card">


<img src="${
p.image ||

'https://picsum.photos/200'

}">


<div class="info">


<h3>

${p.title}

</h3>


‚Çπ${p.price}


<div class="qty">


<button

onclick="minusQty(${i})">

-

</button>


<b>

${p.qty}

</b>


<button

onclick="plusQty(${i})">

+

</button>


</div>


<button

class="remove"

onclick="removeItem(${i})">

Remove ‚ùå

</button>


</div>


</div>

`;

});


document.getElementById(

"cart"

).innerHTML=html;


document.getElementById(

"total"

).innerText=total;


document.getElementById(

"totalBox"

).style.display="block";


localStorage.setItem(

"cart",

JSON.stringify(cart)

);

}



// PLUS

function plusQty(i){

let cart=

JSON.parse(

localStorage.getItem("cart")

)||[];

cart[i].qty++;

localStorage.setItem(

"cart",

JSON.stringify(cart)

);

loadCart();

}



// MINUS

function minusQty(i){

let cart=

JSON.parse(

localStorage.getItem("cart")

)||[];

if(cart[i].qty>1){

cart[i].qty--;

}

localStorage.setItem(

"cart",

JSON.stringify(cart)

);

loadCart();

}



// REMOVE

function removeItem(i){

let cart=

JSON.parse(

localStorage.getItem("cart")

)||[];

cart.splice(i,1);

localStorage.setItem(

"cart",

JSON.stringify(cart)

);

loadCart();

}



// ORDER ALL

async function placeOrder(){

const token=

localStorage.getItem("token");


if(!token){

alert("Login First üîê");

location.href="login.html";

return;

}


let cart=

JSON.parse(

localStorage.getItem("cart")

)||[];


try{


for(let product of cart){

await fetch(

API+"/orders",

{

method:"POST",

headers:{

"Content-Type":

"application/json",

Authorization:

"Bearer "+token

},

body:JSON.stringify({

productId:

product._id

})

});

}


// CLEAR CART

localStorage.removeItem(

"cart"

);


alert("Order Placed üî•");


location.href="orders.html";


}catch{

alert("Order Failed");

}

}


loadCart();

</script>

</body>

</html>
