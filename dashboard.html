<script>

const API="https://creatorhub-f2fe.onrender.com/api";


// â­ SAFE USER GET

let token = localStorage.getItem("token");

let user=null;

try{

user = JSON.parse(

localStorage.getItem("user")

);

}catch{

user=null;

}


// â­ LOGIN SAFE CHECK

if(!token || !user){

alert("Login Required");

location.href="login.html";

}


// USER NAME SAFE

document.getElementById("username")

.innerText=

"Welcome "+(user?.name || "User")+" ðŸ‘‹";



// PROFILE IMAGE SAFE

const savedImg=

localStorage.getItem(

"profile_"+(user?.email || "")

);

if(savedImg){

document.getElementById(

"profileImg"

).src=savedImg;

}


// PROFILE UPLOAD

function uploadProfile(e){

const file=e.target.files[0];

if(!file)return;

const reader=new FileReader();

reader.onload=function(){

localStorage.setItem(

"profile_"+user.email,

reader.result

);

document.getElementById(

"profileImg"

).src=

reader.result;

};

reader.readAsDataURL(file);

}


// NAVIGATION

function go(page){

location.href=page;

}


// LOAD STATS

async function loadStats(){

try{

const p=

await fetch(API+"/products");

const pdata=

await p.json();

document.getElementById(

"productCount"

).innerText=

pdata.products?.length || 0;


const o=

await fetch(API+"/orders",{

headers:{

Authorization:

"Bearer "+token

}

});

const odata=

await o.json();

document.getElementById(

"orderCount"

).innerText=

odata.orders?.length || 0;


let total=0;

odata.orders?.forEach(ord=>{

if(ord.product){

total+=ord.product.price || 0;

}

});

document.getElementById(

"earnings"

).innerText=total;

}

catch(e){

console.log("Stats Error",e);

}

}

loadStats();


// LOGOUT SAFE

function logout(){

localStorage.removeItem("token");

localStorage.removeItem("user");

alert("Logged Out");

location.href="login.html";

}

</script>
