<!DOCTYPE html>
<html lang="en">

<head>

<meta charset="UTF-8">

<meta name="viewport"
content="width=device-width,initial-scale=1">

<title>Upload Ebook - CreatorHub</title>

<style>

/* ===== DEVICE AUTO THEME ===== */

:root{
--bg:#ffffff;
--text:#111827;
--card:#f3f4f6;
--accent:#22c55e;
}

@media (prefers-color-scheme:dark){

:root{

--bg:#020617;
--text:#ffffff;
--card:#111827;

}

}


/* BODY */

body{

margin:0;
font-family:Arial;

background:var(--bg);
color:var(--text);

}


/* HEADER */

.topbar{

display:flex;

align-items:center;

padding:14px;

background:var(--bg);

box-shadow:0 5px 20px rgba(0,0,0,.3);

position:sticky;

top:0;

z-index:99;

}

.back{

font-size:22px;

cursor:pointer;

width:40px;

}

.title{

flex:1;

text-align:center;

font-weight:bold;

font-size:18px;

color:var(--accent);

}


/* CARD */

.container{

padding:20px;

}

.card{

background:var(--card);

padding:25px;

border-radius:18px;

max-width:520px;

margin:auto;

box-shadow:

0 15px 40px rgba(0,0,0,.4);

}


/* TEXT */

h2{

text-align:center;

margin-bottom:15px;

}

.rule{

font-size:13px;

opacity:.7;

margin-bottom:15px;

text-align:center;

}


/* INPUT */

input{

width:100%;

padding:14px;

margin-top:12px;

border:none;

border-radius:10px;

background:rgba(0,0,0,.06);

color:var(--text);

outline:none;

font-size:14px;

}


/* BUTTON */

button{

width:100%;

padding:15px;

margin-top:18px;

background:

linear-gradient(
90deg,#f59e0b,#f97316);

border:none;

border-radius:12px;

font-weight:bold;

cursor:pointer;

color:white;

transition:.3s;

}

button:disabled{

opacity:.5;

cursor:not-allowed;

}


/* PREVIEW */

.preview{

width:100%;

border-radius:12px;

margin-top:12px;

display:none;

animation:fade .4s;

}

@keyframes fade{

from{opacity:0}

to{opacity:1}

}

.fileTitle{

margin-top:15px;

font-size:14px;

opacity:.8;

}

</style>

</head>

<body>


<!-- HEADER -->

<div class="topbar">

<div class="back"

onclick="history.back()">

â¬…

</div>

<div class="title">

ðŸ“˜ Upload Ebook

</div>

</div>



<div class="container">

<div class="card">


<h2>

Upload Digital Ebook

</h2>


<p class="rule">

âš  Copyright or illegal content upload allowed à¤¨à¤¹à¥€à¤‚ à¤¹à¥ˆ.

Admin approval required before public listing.

</p>



<input id="title"

placeholder="Ebook Title">



<input id="price"

type="number"

placeholder="Price â‚¹">



<div class="fileTitle">

Cover Image (Max 5MB)

</div>


<input type="file"

accept="image/*"

onchange="previewImage(event)">



<img id="preview"

class="preview">



<div class="fileTitle">

Select Ebook PDF (Max 15MB)

</div>



<input type="file"

accept="application/pdf"

onchange="loadPDF(event)">



<button id="uploadBtn"

onclick="uploadBook()">

Upload Ebook ðŸš€

</button>


</div>

</div>



<script>

/* API */

const API=

"https://script.google.com/macros/s/AKfycbw7xwjcEGIdj3xS8q7qhRNCSbch2uVsXFGFJYWgMNU4UPA-2BSfhq79PHsQ_oCEeYTm/exec";



/* LOGIN */

let user=

JSON.parse(localStorage.getItem("user"));

let token=

localStorage.getItem("token");


if(!user||!token){

alert("Login First");

location.href="login.html";

}



/* BASE64 */

let imageBase64="";

let pdfBase64="";


/* IMAGE */

function previewImage(e){

let file=e.target.files[0];

if(!file)return;


if(file.size>

5*1024*1024){

alert("Image max 5MB");

return;

}


let reader=new FileReader();

reader.onload=()=>{

imageBase64=reader.result;

preview.src=imageBase64;

preview.style.display="block";

};

reader.readAsDataURL(file);

}


/* PDF */

function loadPDF(e){

let file=e.target.files[0];

if(!file)return;


if(file.size>

15*1024*1024){

alert("PDF max 15MB");

return;

}


let reader=new FileReader();

reader.onload=()=>{

pdfBase64=reader.result;

};

reader.readAsDataURL(file);

}


/* DB */

async function getDB(db){

const res=

await fetch(API+"?db="+db);

return await res.json();

}


async function saveDB(db,data){

await fetch(API,{

method:"POST",

body:JSON.stringify({

db,data

})

});

}



/* UPLOAD FINAL */

async function uploadBook(){

const btn=

document.getElementById("uploadBtn");

btn.disabled=true;

btn.innerText="Uploading...";


let title=

document.getElementById("title")

.value.trim();

let price=

document.getElementById("price")

.value.trim();


if(

!title||

!price||

!imageBase64||

!pdfBase64

){

alert("Fill All Fields");

btn.disabled=false;

btn.innerText="Upload Ebook ðŸš€";

return;

}


if(title.length<3){

alert("Invalid Title");

btn.disabled=false;

btn.innerText="Upload Ebook ðŸš€";

return;

}


try{


const res=

await fetch(API,{

method:"POST",

body:JSON.stringify({

action:"uploadFile",

image:imageBase64,

pdf:pdfBase64

})

});


let file=

await res.json();


if(!file.success){

throw "Upload Failed";

}


let products=

await getDB("products")||[];


products.push({

id:Date.now(),

title,

price:Number(price),

image:file.image,

pdf:file.pdf,

owner:user.email,

status:"pending",

date:new Date().toLocaleString()

});


await saveDB(

"products",

products

);


alert(

"Upload Successful âœ… Waiting Admin Approval"

);

location.href="products.html";


}catch(e){

console.log(e);

alert("Upload Error");

btn.disabled=false;

btn.innerText="Upload Ebook ðŸš€";

}

}

</script>

</body>

</html>
