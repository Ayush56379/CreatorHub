<!DOCTYPE html>
<html>

<head>

<title>Upload Ebook - CreatorHub</title>

<meta name="viewport" content="width=device-width,initial-scale=1">

<style>

body{
margin:0;
font-family:Arial;
background:#111;
color:white;
}

nav{
background:black;
padding:15px;
display:flex;
justify-content:space-between;
}

a{
color:white;
text-decoration:none;
margin-left:15px;
font-weight:bold;
}

.back{
background:#222;
padding:10px;
text-align:center;
cursor:pointer;
}

.container{
display:flex;
justify-content:center;
align-items:center;
height:85vh;
}

.card{
background:#222;
padding:30px;
width:360px;
border-radius:12px;
box-shadow:0 0 15px black;
text-align:center;
}

input{
width:100%;
padding:12px;
margin-top:12px;
border:none;
border-radius:6px;
}

button{
width:100%;
padding:13px;
background:orange;
border:none;
margin-top:15px;
font-size:16px;
border-radius:6px;
cursor:pointer;
font-weight:bold;
}

img{
width:100%;
margin-top:12px;
border-radius:10px;
display:none;
}

label{
display:block;
text-align:left;
margin-top:12px;
}

</style>

</head>

<body>


<nav>

<div>üì¶ CreatorHub Upload</div>

<div>

<a href="dashboard.html">Dashboard</a>

<a href="products.html">Products</a>

</div>

</nav>


<div class="back" onclick="history.back()">

‚¨Ö Back

</div>



<div class="container">

<div class="card">

<h2>

üìò Upload Ebook

</h2>


<input id="title"

placeholder="Ebook Title">


<input id="price"

type="number"

placeholder="Price">


<label>

Cover Image URL (Drive / Internet)

</label>

<input id="image"

placeholder="Paste Image Link"

onkeyup="previewImage()">



<img id="preview">



<label>

Google Drive PDF Direct Download Link

</label>

<input id="pdf"

placeholder="Paste Drive PDF Link">



<button id="uploadBtn"

onclick="uploadProduct()">

Upload Ebook üöÄ

</button>


<br><br>

<a href="dashboard.html">

‚¨Ö Back Dashboard

</a>


</div>

</div>



<script>

const API=

"https://creatorhub-f2fe.onrender.com/api";


// LOGIN CHECK

const token=

localStorage.getItem("token");

if(!token){

alert("Login First");

location.href="login.html";

}


// ‚≠ê IMAGE PREVIEW

function previewImage(){

let url=

document.getElementById("image").value.trim();

let img=

document.getElementById("preview");


if(url){

img.src=url;

img.style.display="block";

}else{

img.style.display="none";

}

}



// ‚≠ê UPLOAD PRODUCT FINAL

async function uploadProduct(){

const btn=

document.getElementById("uploadBtn");

btn.innerText="Uploading...";


const title=

document.getElementById("title").value.trim();

const price=

document.getElementById("price").value;

let image=

document.getElementById("image").value.trim();

let pdf=

document.getElementById("pdf").value.trim();


// VALIDATION

if(!title||!price||!image||!pdf){

alert("Fill All Fields");

btn.innerText="Upload Ebook üöÄ";

return;

}


// ‚≠ê DRIVE PDF AUTO CONVERT

if(pdf.includes("drive.google.com")){

const id=pdf.split("/d/")[1]?.split("/")[0];

if(id){

pdf=

"https://drive.google.com/uc?export=download&id="+id;

}

}


try{


const res=

await fetch(

API+"/products",

{

method:"POST",

headers:{

"Content-Type":"application/json",

Authorization:"Bearer "+token

},

body:JSON.stringify({

title,

price:Number(price),

image,

pdf

})

});


const data=

await res.json();


if(!res.ok){

throw new Error("Upload Failed");

}


alert(

data.message||

"Ebook Uploaded Successfully üî•"

);


// DASHBOARD REDIRECT

location.href="dashboard.html";


}catch(err){

console.log(err);

alert("Upload Failed ‚ùå");

}


btn.innerText="Upload Ebook üöÄ";

}

</script>

</body>

</html>
