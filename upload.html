<!DOCTYPE html>
<html>
<head>

<meta name="viewport" content="width=device-width,initial-scale=1">

<title>Upload Ebook - CreatorHub</title>

<style>

body{

margin:0;
font-family:Arial;
background:#020617;
color:white;
padding:20px;

}

.card{

background:#111827;
padding:25px;
border-radius:18px;
max-width:520px;
margin:auto;

box-shadow:
0 15px 40px rgba(0,0,0,.7);

}

h2{

text-align:center;
margin-bottom:20px;

}

input{

width:100%;
padding:14px;
margin-top:12px;
border:none;
border-radius:10px;
background:#020617;
color:white;

}

button{

width:100%;
padding:15px;
margin-top:18px;

background:

linear-gradient(
90deg,#f59e0b,#f97316);

border:none;

border-radius:12px;

font-weight:bold;

cursor:pointer;

}

.preview{

width:100%;
border-radius:12px;
margin-top:12px;
display:none;

}

.back{

background:#2563eb;
padding:10px 18px;
border-radius:10px;
display:inline-block;
cursor:pointer;
margin-bottom:15px;

}

</style>

</head>

<body>

<div class="back"
onclick="history.back()">

‚¨Ö Back

</div>

<div class="card">

<h2>

üìò Upload Ebook

</h2>


<input id="title"
placeholder="Ebook Title">


<input id="price"
placeholder="Price ‚Çπ">


<h4>Cover Image</h4>

<input type="file"

accept="image/*"

onchange="previewImage(event)">


<img id="preview"
class="preview">


<h4>Select PDF</h4>

<input type="file"

accept="application/pdf"

onchange="loadPDF(event)">



<button onclick="uploadBook()">

Upload Ebook üöÄ

</button>

</div>


<script>


// ‚≠ê GOOGLE DRIVE API

const API=

"https://script.google.com/macros/s/AKfycbw7xwjcEGIdj3xS8q7qhRNCSbch2uVsXFGFJYWgMNU4UPA-2BSfhq79PHsQ_oCEeYTm/exec";



// LOGIN CHECK

let user=

JSON.parse(

localStorage.getItem("user")

);

let token=

localStorage.getItem("token");


if(!user || !token){

alert("Login First");

location.href="login.html";

}



// BASE64 DATA

let imageBase64="";

let pdfBase64="";



// IMAGE PREVIEW

function previewImage(e){

let file=e.target.files[0];

if(!file)return;


let reader=new FileReader();

reader.onload=function(){

imageBase64=reader.result;

preview.src=imageBase64;

preview.style.display="block";

};

reader.readAsDataURL(file);

}



// PDF LOAD

function loadPDF(e){

let file=e.target.files[0];

if(!file)return;


let reader=new FileReader();

reader.onload=function(){

pdfBase64=reader.result;

};

reader.readAsDataURL(file);

}




// DRIVE SAVE

async function saveDB(db,data){

await fetch(API,{

method:"POST",

body:JSON.stringify({

db:db,

data:data

})

});

}



// GET DB

async function getDB(db){

const res=

await fetch(API+"?db="+db);

return await res.json();

}




// UPLOAD FINAL ‚≠ê‚≠ê‚≠ê

async function uploadBook(){


let title=

document.getElementById("title").value.trim();

let price=

document.getElementById("price").value.trim();


if(

!title ||

!price ||

!imageBase64 ||

!pdfBase64

){

alert("Fill All Fields");

return;

}


alert("Uploading To Google Drive...");


try{


// DRIVE IMAGE + PDF UPLOAD

const res=

await fetch(API,{

method:"POST",

body:JSON.stringify({

action:"uploadFile",

image:imageBase64,

pdf:pdfBase64

})

});


let file=

await res.json();


if(!file.success){

alert("Upload Failed");

return;

}



// LOAD PRODUCTS

let products=

await getDB("products");




// SAVE PRODUCT

products.push({

id:Date.now(),

title:title,

price:Number(price),

image:file.image,

pdf:file.pdf,

owner:user.email,

date:new Date().toLocaleString()

});




// SAVE PRODUCTS DRIVE

await saveDB(

"products",

products

);


alert("Upload Successful ‚úÖ");


location.href="products.html";


}catch(e){

console.log(e);

alert("Upload Error");

}

}

</script>

</body>

</html>
