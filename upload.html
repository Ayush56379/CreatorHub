<!DOCTYPE html>
<html>
<head>

<meta name="viewport"
content="width=device-width,initial-scale=1">

<title>Upload Ebook - CreatorHub</title>

<style>

body{

margin:0;
font-family:Arial;

background:
linear-gradient(
180deg,
#020617,
#111827
);

color:white;

}


/* HEADER */

.header{

display:flex;
align-items:center;
gap:10px;

padding:15px;

background:#000;

}

.back{

background:#2563eb;

padding:10px 16px;

border-radius:10px;

cursor:pointer;

}


/* CARD */

.card{

background:

rgba(31,41,55,.9);

margin:20px;

padding:22px;

border-radius:18px;

box-shadow:

0 10px 30px rgba(0,0,0,.6);

}


/* INPUT */

input{

width:100%;

padding:14px;

margin-top:12px;

border:none;

border-radius:10px;

background:#020617;

color:white;

outline:none;

}


/* BUTTON */

button{

width:100%;

padding:15px;

margin-top:18px;

border:none;

border-radius:14px;

font-weight:bold;

font-size:16px;

cursor:pointer;

background:

linear-gradient(
90deg,
orange,
#f59e0b
);

}


/* IMAGE */

.preview{

width:100%;

margin-top:12px;

border-radius:12px;

display:none;

}


/* LOADER */

.loader{

display:none;

text-align:center;

margin-top:10px;

}

.spinner{

border:5px solid #111;

border-top:5px solid orange;

width:40px;

height:40px;

border-radius:50%;

animation:spin 1s linear infinite;

margin:auto;

}

@keyframes spin{

100%{

transform:rotate(360deg);

}

}

</style>

</head>


<body>


<div class="header">

<div class="back"

onclick="history.back()">

‚¨Ö Back

</div>

<h3>

üìò Upload Ebook

</h3>

</div>



<div class="card">


<input id="title"

placeholder="Ebook Title">


<input id="price"

placeholder="Price ‚Çπ">


<h4>

Choose Cover Image

</h4>

<input type="file"

accept="image/*"

onchange="previewImage(event)">



<img id="preview"

class="preview">



<h4>

Select PDF

</h4>


<input type="file"

accept="application/pdf"

onchange="previewPDF(event)">



<button

onclick="uploadBook()">

Upload Ebook üöÄ

</button>


<div class="loader"

id="loader">

<div class="spinner"></div>

<p>

Uploading To Google Drive...

</p>

</div>


</div>



<script>


// ‚≠ê YOUR NEW API ‚≠ê

const DRIVE_API=

"https://script.google.com/macros/s/AKfycbz_5CJPDBUTQgVEGaFcmQYQ9DK70CxVvvvS9CyVtxKvQC-SUI0RRQzMEsGMIdK_DMok/exec";




// LOGIN CHECK

const user=

JSON.parse(

localStorage.getItem("user")

);


const token=

localStorage.getItem("token");


if(!user||!token){

alert("Login First");

location.href="login.html";

}



let imageBase64="";

let pdfBase64="";




// IMAGE PREVIEW

function previewImage(e){

const file=e.target.files[0];

if(!file)return;

const reader=new FileReader();

reader.onload=function(){

imageBase64=reader.result;

preview.src=imageBase64;

preview.style.display="block";

};

reader.readAsDataURL(file);

}



// PDF LOAD

function previewPDF(e){

const file=e.target.files[0];

if(!file)return;

const reader=new FileReader();

reader.onload=function(){

pdfBase64=reader.result;

};

reader.readAsDataURL(file);

}




// ‚≠ê FINAL UPLOAD ‚≠ê

async function uploadBook(){


let title=

document.getElementById("title")

.value.trim();


let price=

document.getElementById("price")

.value.trim();


if(!title||!price||

!imageBase64||!pdfBase64){

alert("Fill all fields");

return;

}



document.getElementById(

"loader"

).style.display="block";



try{


const res=

await fetch(

DRIVE_API,

{

method:"POST",

body:JSON.stringify({

title:title,

image:imageBase64,

pdf:pdfBase64

})

});



const data=

await res.json();



if(!data.success){

alert("Upload Failed");

return;

}



// SAVE PRODUCT

let products=

JSON.parse(

localStorage.getItem(

"products"

)

)||[];



products.push({

id:Date.now(),

title:title,

price:price,

image:data.image,

pdf:data.pdf,

owner:user.email

});



localStorage.setItem(

"products",

JSON.stringify(products)

);



alert("Upload Successful ‚úÖ");



location.href="products.html";


}catch(e){

alert("Upload Error");

console.log(e);

}



document.getElementById(

"loader"

).style.display="none";

}


</script>


</body>

</html>
